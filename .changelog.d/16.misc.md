Refactored code for better maintainability and readability
